package me.coolmint.ngm.features.modules.exploit;

import com.google.common.eventbus.Subscribe;
import me.coolmint.ngm.event.impl.PacketEvent;
import me.coolmint.ngm.features.modules.Module;
import me.coolmint.ngm.features.settings.Setting;
import me.coolmint.ngm.mixin.IExplosionS2CPacket;
import net.minecraft.item.Items;
import net.minecraft.network.packet.s2c.play.ExplosionS2CPacket;

public class WindChargeExploit extends Module {
    private final Setting<Integer> velocity = register(new Setting<>("Velocity", 800, 100, 1500, "Exploit Height"));

    public WindChargeExploit() {
        super("WindChargeExploit", "works on non anticheat server", Category.EXPLOIT, true, false, false);
    }

    @Subscribe
    public void onPacketReceive(PacketEvent.ReceivePRE e) {
        if (mc.player == null || mc.player.getInventory() == null) return;

        if(!mc.player.getItemCooldownManager().isCoolingDown(Items.WIND_CHARGE)) return;

        if (e.getPacket() instanceof ExplosionS2CPacket explosion) {
            ((IExplosionS2CPacket) explosion).setMotionY(((IExplosionS2CPacket) explosion).getMotionY() * velocity.getValue() / 100f);
        }
    }
}